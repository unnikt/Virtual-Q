<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book New</title>
    <link rel="shortcut icon" href="">

    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/calendar.css">
    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="/__/firebase/7.14.5/firebase-app.js"></script>
    <!-- Add Firebase products that you want to use -->
    <script src="/__/firebase/7.14.5/firebase-auth.js"></script>
    <!-- Initialize Firebase -->
    <script src="/__/firebase/init.js"></script>
    <style>
        .review {
            font-size: 1em;
            padding: 0;
            margin: 12px;
        }

        .review label {
            margin: 1px;
            padding: 12px;
            font-size: 1em;
            background: var(--light-background);
            color: black;
        }

        input[type=checkbox] {
            margin: 12px 24px;
            width: 20px;
            height: 20px;
        }

        .results {
            margin-top: 24px;
        }

        .results a {
            text-decoration: underline;
            padding: 12px;
            margin: 2px;
            width: 90%;
            background: var(--light-background);
            color: blue;
        }

        .mod-Dialog {
            padding: 12px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            position: absolute;
            background: var(--light-background);
        }

        .mod-Dialog>p {
            font-size: 18px;
            padding: 12px;
        }

        .mod-Dialog>a {
            width: 90%;
            margin: 4px auto;
        }
    </style>
</head>

<body>
    <div class="grid bbdr">
        <i class="material-icons gicon-regular" onclick="openNav()">menu</i>
        <h3 class="apptitle" style="grid-area: 1/2/span 1 / span 9;margin: 0;"> VirQ.app</h3>
    </div>
    <div id="mainNav" class="overlay">
        <div class="overlay-content">
            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
            <select name="" id="lstBus" onchange="setBid()"></select>
            <a class="tile" href="javascript:redirect('booknew.html?bid=')">New Booking</a>
            <a class="tile" href="javascript:redirect('skedules?bid=')">View Calendar</a>
            <a class="tile" href="javascript:redirect('settings?bid=')">Settings</a>
            <a class="tile" href="javascript:auth.signOut();">Log out</a>
            <p class="theme">Keep the distance .. Save time</p>
        </div>
    </div>

    <ul class="tabs" id="tabs">
        <li id="tab1" onclick="setTab('divCustomer','tab1')">Customer</li>
        <li id="tab2" onclick="getServices('divServices','tab2')">Services</li>
        <li id="tab3" onclick="setTab('divCalendar','tab3')">Date & Time</li>
        <li id="tab4" onclick="showReview('divReview','tab4')">Review</li>
    </ul>

    <div id="divCustomer" >
        <div id="divSearch" class="grid" style="display: grid; grid-template-columns: 11fr 1fr;">
            <input id="inpSearch" type="text" class="searchbox" placeholder="Enter email / phone" tabindex="1"
                style="border: 0;margin: 0;">
            <i id="iSearch" class="material-icons" tabindex="2" onclick="searchCustomer()">search</i>
        </div>
        <div class="grid">
            <label for="">Or Add new Customer</label>
            <form id="newuser" action="POST" class="show">
                <input type="text" id="fname" placeholder="First Name" autocomplete="given-name">
                <input type="text" id="sname" placeholder="Sur Name" autocomplete="family-name">
                <input type="tel" id="phone" placeholder="Phone Name" autocomplete="tel">
                <input type="email" id="email" placeholder="Emaid Id" autocomplete="email" required>
                <input type="button" value="Next" onclick="getServices('divServices')">
            </form>
        </div>
    </div>

    <div id="divServices" hidden>
    <div id="svcgrid" class="grid"></div>
    </div>

    <div id="divCalendar" hidden>
        <div class="cal-header">
            <!-- <i id="prev-m" class="material-icons cal-icon" onclick="minimise()">expand_less</i> -->
            <i id="prev-m" class="material-icons " onclick="localCMY('mon', 'prev')">chevron_left</i>
            <p id="month" style="margin:12px;"></p>
            <i id="next-m" class="material-icons " onclick="localCMY('mon', 'next')">chevron_right</i>
            <i id="prev-y" class="material-icons " onclick="localCMY('year', 'prev')">chevron_left</i>
            <p id="year" style="margin:12px;"></p>
            <i id="next-y" class="material-icons " onclick="localCMY('year', 'next')">chevron_right</i>
            <i id="icnfold" class="material-icons " onclick="fold('icnfold','cal-container')">expand_less</i>
        </div>
        <div id="cal-container" style="display: block;">
            <div id="cal-dates" class="cal-dates"></div>
        </div>
        <!-- <input type="button" value="Next" onclick="showReview('divReview')"> -->

        <div class="grid">
            <div class="grid nopad" id="evnt-lst"></div>
        </div>
    </div>

    <div id="divReview" hidden>
        <h3 class="bbdr">Review and Confirm Booking</h3>
        <div class="grid review" style="grid-template-columns: 4fr 7fr;">
            <label>Name</label>
            <label id="name">Name</label>
            <label>Email</label>
            <label id="mail">@email.com</label>
            <label>Phone</label>
            <label id="tel">000 000 00 00 </label>
            <label>Service</label>
            <label id="svc">Service ID</label>
            <label>Start</label>
            <label id="start">10:30 AM</label>
            <label>End</label>
            <label id="end">10:30 AM</label>
        </div>

        <div class="grid" style="grid-template-columns: 8fr 1fr 1fr 1fr 1fr ; padding:0;margin: 12px;">
            <label>Send notifications to</label>
            <input type="checkbox" placeholder="Notify" value="email" id="notem" onclick="setNotify('email')"><label
                style="margin-left: 0;">Email</label>
            <input type="checkbox" placeholder="Notify" value="phone" id="nottel" onclick="setNotify('phone')"><label
                style="margin-left: 0;">Phone</label>

        </div>

        <button onclick="saveBooking()" id="submit" disabled>Confirm Booking</button>
    </div>

    <div id="divfinal" class="mod-Dialog shdw" hidden>
        <p class="fmont">Booking Saved successfully</p>
        <a href="javascript:redirect('booknew.html?bid=')" class="a-settings">Make another booking</a>
        <a href="javascript:redirect('skedules?bid=')" class="a-settings">View Calendar</a>
    </div>

    <div class="mod-container" id="selCustomer">
        <div class="mod-content" style="overflow-y: scroll; height: 60%;">
            <div class="grid bbdr" style="grid-template-columns: 11fr 1fr;">
                <h4>Search Results</h4>
                <i class="material-icons" style="display: inline;"
                    onclick="document.getElementById('selCustomer').style.display='none'">close</i>
            </div>
            <div class="grid results" id="srchResult"></div>
        </div>
    </div>



    <script src="js/app.js"></script>
    <script src="js/calendar.js"></script>
    <script src="js/business.js"></script>
    <script src="js/booknew.js" defer></script>

    <script>
        //***********************************************************************
        const calDates = get('cal-dates').children;
        drawCalendar();
        // fetchEvents();
        setDateClicks();

        function fetchEvents() {
            spinner();
            //  fetch ('/getCalendar',params:{POST:}}) 
            inputs.id='bid';inputs.val=bid;
            params.body = JSON.stringify(inputs)
            fetch("/getevents", params)
                .then(response => response.json()
                    .then(data => { showEvents(data.events, 'evnt-lst'); spinner('stop') }))
                .catch(err => { console.log(err); spinner('stop'); });
        }
        function localCMY(mon_year, prev_next) {
            changeMonthYear(mon_year, prev_next);
            fetchEvents();
            setDateClicks();
        }
        //***********************************************************************
        get('iSearch').addEventListener('keyup', (e) => { if (e.keyCode == 13) searchCustomer() });
        get('inpSearch').addEventListener('keyup', (e) => { if (e.keyCode == 13) searchCustomer() });
    </script>
</body>

</html>